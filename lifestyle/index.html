<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shashank Lifestyle Tracker</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Styles -->
  <style>
    body { background: #f7f8fb; font-family: 'Inter', sans-serif; }
    .glass { backdrop-filter: blur(15px); background: rgba(255,255,255,.7); border: 1px solid rgba(255,255,255,.5); box-shadow: 0 10px 30px rgba(2,6,23,.08); }
    .toggle-on { background: #10b981 !important; color: #fff !important; }
    .toggle-off { background: #e2e8f0 !important; color: #475569 !important; }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(12px);} to { opacity: 1; transform: translateY(0);} }
    .animate-in { animation: fadeInUp .5s ease both; }
    @keyframes gradientX { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
    .btn-animated { background: linear-gradient(90deg,#3b82f6,#10b981,#8b5cf6); background-size:200% 100%; animation: gradientX 4s ease infinite alternate; color:#fff; }
  </style>

  <!-- PWA Manifest -->
  <link rel="manifest" href="pwa/manifest.json" />
</head>

<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("pwa/service-worker.js");
  }
</script>

<body class="min-h-screen flex flex-col">

  <!-- HEADER -->
  <header class="w-full py-6 shadow-sm glass animate-in">
    <div class="max-w-5xl mx-auto px-4">
      <h1 class="text-3xl font-bold text-gray-800">ğŸŒ¿ Shashank's Lifestyle Tracker</h1>
      <p class="text-gray-500 text-sm mt-1">Health â€¢ Fitness â€¢ Habits â€¢ Productivity</p>
    </div>
  </header>

  <main class="flex-1 px-4 md:px-8 lg:px-12 py-8 space-y-10">

    <!-- REMINDER MODULES (kept from dashboard) -->
    <section class="max-w-5xl mx-auto animate-in">
      <h2 class="text-xl font-semibold text-gray-700 mb-4">Reminder Modules</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

        <!-- Exercise -->
        <div class="glass p-4 rounded-xl shadow flex flex-col justify-between">
          <div>
            <h3 class="text-lg font-semibold text-gray-700">ğŸ‹ï¸ Exercise</h3>
            <p class="text-gray-500 text-sm">Gym + mobility reminders</p>
          </div>
          <div class="flex gap-2 mt-4">
            <button id="toggle-exercise" class="flex-1 py-2 rounded-lg toggle-off font-medium shadow">Enable</button>
            <button type="button" onclick="window.testWebhook('exercise')" class="px-3 py-2 rounded-lg shadow btn-animated">Test</button>
          </div>
        </div>

        <!-- Food -->
        <div class="glass p-4 rounded-xl shadow flex flex-col justify-between">
          <div>
            <h3 class="text-lg font-semibold text-gray-700">ğŸ½ Food</h3>
            <p class="text-gray-500 text-sm">Breakfast, lunch, dinner reminders</p>
          </div>
          <div class="flex gap-2 mt-4">
            <button id="toggle-food" class="flex-1 py-2 rounded-lg toggle-off font-medium shadow">Enable</button>
            <button type="button" onclick="window.testWebhook('food')" class="px-3 py-2 rounded-lg shadow btn-animated">Test</button>
          </div>
        </div>

        <!-- Water -->
        <div class="glass p-4 rounded-xl shadow flex flex-col justify-between">
          <div>
            <h3 class="text-lg font-semibold text-gray-700">ğŸ’§ Water</h3>
            <p class="text-gray-500 text-sm">Hydration reminders throughout day</p>
          </div>
          <div class="flex gap-2 mt-4">
            <button id="toggle-water" class="flex-1 py-2 rounded-lg toggle-off font-medium shadow">Enable</button>
            <button type="button" onclick="window.testWebhook('water')" class="px-3 py-2 rounded-lg shadow btn-animated">Test</button>
          </div>
        </div>

        <!-- Work -->
        <div class="glass p-4 rounded-xl shadow flex flex-col justify-between">
          <div>
            <h3 class="text-lg font-semibold text-gray-700">ğŸ’» Work</h3>
            <p class="text-gray-500 text-sm">Productivity + focus reminders</p>
          </div>
          <div class="flex gap-2 mt-4">
            <button id="toggle-work" class="flex-1 py-2 rounded-lg toggle-off font-medium shadow">Enable</button>
            <button type="button" onclick="window.testWebhook('work')" class="px-3 py-2 rounded-lg shadow btn-animated">Test</button>
          </div>
        </div>

        <!-- Sleep -->
        <div class="glass p-4 rounded-xl shadow flex flex-col justify-between">
          <div>
            <h3 class="text-lg font-semibold text-gray-700">ğŸ˜´ Sleep</h3>
            <p class="text-gray-500 text-sm">Sleep routine + wind-down reminders</p>
          </div>
          <div class="flex gap-2 mt-4">
            <button id="toggle-sleep" class="flex-1 py-2 rounded-lg toggle-off font-medium shadow">Enable</button>
            <button type="button" onclick="window.testWebhook('sleep')" class="px-3 py-2 rounded-lg shadow btn-animated">Test</button>
          </div>
        </div>

      </div>
    </section>

    <!-- SETTINGS (merged from settings.html) -->
    <section class="max-w-5xl mx-auto animate-in" style="animation-delay:.05s">
      <h2 class="text-xl font-semibold text-gray-700 mb-4">âš™ï¸ Edit Reminder Times</h2>

      <!-- Exercise -->
      <div class="glass card p-5 rounded-2xl shadow mb-6">
        <h3 class="text-lg font-semibold text-gray-700">ğŸ‹ï¸ Exercise</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
          <div><label class="text-gray-600 text-sm">Morning Mobility</label><input type="time" id="ex_morning" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Gym / Swimming</label><input type="time" id="ex_gym" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Protein Shake</label><input type="time" id="ex_shake" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
        </div>
      </div>

      <!-- Food -->
      <div class="glass card p-5 rounded-2xl shadow mb-6">
        <h3 class="text-lg font-semibold text-gray-700">ğŸ½ Food</h3>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-4">
          <div><label class="text-gray-600 text-sm">Breakfast</label><input type="time" id="fd_breakfast" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Lunch</label><input type="time" id="fd_lunch" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Snack</label><input type="time" id="fd_snack" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Dinner</label><input type="time" id="fd_dinner" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
        </div>
      </div>

      <!-- Water -->
      <div class="glass card p-5 rounded-2xl shadow mb-6">
        <h3 class="text-lg font-semibold text-gray-700">ğŸ’§ Water</h3>
        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mt-4">
          <div><label class="text-gray-600 text-sm">Morning</label><input type="time" id="wt_1" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Mid-Morning</label><input type="time" id="wt_2" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">After Lunch</label><input type="time" id="wt_3" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Evening</label><input type="time" id="wt_4" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Pre-Workout</label><input type="time" id="wt_5" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
        </div>
      </div>

      <!-- Work -->
      <div class="glass card p-5 rounded-2xl shadow mb-6">
        <h3 class="text-lg font-semibold text-gray-700">ğŸ’» Work</h3>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-4">
          <div><label class="text-gray-600 text-sm">Start</label><input type="time" id="wk_start" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Break</label><input type="time" id="wk_break" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Refocus</label><input type="time" id="wk_focus" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Wrap</label><input type="time" id="wk_wrap" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
        </div>
      </div>

      <!-- Sleep -->
      <div class="glass card p-5 rounded-2xl shadow mb-24">
        <h3 class="text-lg font-semibold text-gray-700">ğŸ˜´ Sleep</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
          <div><label class="text-gray-600 text-sm">Wind Down</label><input type="time" id="sl_wind" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Brush Teeth</label><input type="time" id="sl_brush" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
          <div><label class="text-gray-600 text-sm">Sleep Time</label><input type="time" id="sl_sleep" class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2"/></div>
        </div>
      </div>

      <!-- Save/Reset bar -->
      <div class="fixed bottom-0 left-0 w-full px-6 py-4 bg-gradient-to-r from-blue-50/80 via-emerald-50/80 to-violet-50/80 backdrop-blur-md shadow-inner border-t border-white/60">
        <div class="max-w-5xl mx-auto flex gap-4">
          <button id="saveBtn" class="flex-1 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-xl shadow hover:from-blue-700 hover:to-indigo-700 transition">Save All</button>
          <button id="resetBtn" class="flex-1 py-3 bg-white text-gray-700 font-semibold rounded-xl shadow border border-gray-200 hover:bg-gray-50 transition">Reset Defaults</button>
        </div>
      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer class="w-full text-center py-6 text-gray-400 text-sm">
    Made with â¤ï¸ by Shashank
  </footer>

  <!-- App Scripts -->
  <script src="js/scheduler.js"></script>
  <script src="js/app.js"></script>

  <!-- Settings logic -->
  <script>
    const defaultTimes = {
      exercise: { ex_morning: "08:00", ex_gym: "18:30", ex_shake: "20:00" },
      food: { fd_breakfast: "08:30", fd_lunch: "13:00", fd_snack: "16:30", fd_dinner: "21:00" },
      water:{ wt_1:"08:15", wt_2:"10:30", wt_3:"13:15", wt_4:"16:00", wt_5:"19:00" },
      work: { wk_start: "09:00", wk_break: "11:00", wk_focus: "14:00", wk_wrap: "17:00" },
      sleep:{ sl_wind:"23:00", sl_brush:"23:30", sl_sleep:"00:00" }
    };

    function loadTimes() {
      const saved = JSON.parse(localStorage.getItem("reminderTimes")) || defaultTimes;
      for (let section in saved) {
        for (let key in saved[section]) {
          const el = document.getElementById(key);
          if (el) el.value = saved[section][key];
        }
      }
    }

    function saveTimes() {
      const data = {
        exercise: { ex_morning: ex_morning.value, ex_gym: ex_gym.value, ex_shake: ex_shake.value },
        food: { fd_breakfast: fd_breakfast.value, fd_lunch: fd_lunch.value, fd_snack: fd_snack.value, fd_dinner: fd_dinner.value },
        water:{ wt_1: wt_1.value, wt_2: wt_2.value, wt_3: wt_3.value, wt_4: wt_4.value, wt_5: wt_5.value },
        work: { wk_start: wk_start.value, wk_break: wk_break.value, wk_focus: wk_focus.value, wk_wrap: wk_wrap.value },
        sleep:{ sl_wind: sl_wind.value, sl_brush: sl_brush.value, sl_sleep: sl_sleep.value }
      };
      localStorage.setItem("reminderTimes", JSON.stringify(data));
      alert("Reminder times saved successfully!");

      // Re-init enabled workers with new times
      const enabled = JSON.parse(localStorage.getItem('enabledWorkers')||'[]');
      enabled.forEach(name => { if (window.stopWorker) stopWorker(name); });
      enabled.forEach(name => { if (window.startWorker) startWorker(name); });
    }

    function resetDefaults() {
      localStorage.setItem("reminderTimes", JSON.stringify(defaultTimes));
      loadTimes();
      alert("Times reset to defaults.");
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadTimes();
      document.getElementById('saveBtn').addEventListener('click', saveTimes);
      document.getElementById('resetBtn').addEventListener('click', resetDefaults);
    });
  </script>

</body>
</html>
